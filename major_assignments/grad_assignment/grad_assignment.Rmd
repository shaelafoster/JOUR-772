---
title: "grad_student_assignment"
author: "Shaela Foster"
date: "2023-12-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(janitor)
library(tidycensus)
library(ggthemes)
```

----------------------------------------------------------------------------------------------------------------------------
(1) Loading Data
```{r}
violent_property_crime <- read_csv("data/violent_crime_property_crime_by_county_1975_to_present.csv") |> clean_names()
```
- Upon completing an initial running of the data and quick browse, I noticed the column headers were large. I cleaned the headers to make them all lowercase. 
- The information within this data set was collected by the Governor's Office of Crime Prevention, Youth and Victim Services and is updated by the Department of Information Technology. It was last updated on May 23, 2022
- There are 1,104 rows and 38 columns. 
    a) Each row represents a county in the state of Maryland, a year from 1975-2020, the population during that year and how many murders, raps, aggravated assaults, break and entering, larceny thefts, motor vehicle theft and robberies there were in each county during that year. It then adds it all up into a grand_total column then breaks it down to see how many of the grand total were violent crimes (murder, robbery, rape and aggravated assault) and property crime (break and entering, larceny theft and motor vehicle theft)
    b) There are multiple columns with calculations like percent change, per captia and violent or property crime percent and percent change. I attempted to replicate the percent change numbers but failed to calculate the exact answers as the data set provides. I'm not sure how they calculated the numbers, but the only calculations I can confirm are correct from my calculations would be the violent_crime_percent, property_crime_percent, violent and property crime totals and per 100,000 crime rate for each crime listed. 
- There are a few rows containing information from 1975 for percent change that have been replaced with N/A. This could be to them using 1975 as the first year in their percent change calculations. 

----------------------------------------------------------------------------------------------------------------------------

(2) Basic total calculations to see what year and county produced the most crimes by arranging the grand_total column.
```{r}
totals <- violent_property_crime |>
  group_by(jurisdiction, year) |>
  arrange(desc(grand_total)) |>
  select(jurisdiction, year, grand_total)
```
- Baltimore City in 1995 had the highest total crimes both violent and property with 96,243. The least amount was Kent County with 152 in 2020.
- 1995 Baltimore City was surprising because I didn't know crime had been high in Baltimore since the 90s. I thought it just started spiking from 2010 and beyond.
- The first 27 results were from Baltimore City with Prince George's County right behind ranked 28th.
- Kent County tanked at the bottom in 2020, which wasn't that much of a shock since 2020 crime stats were low for many cities and college campuses.

----------------------------------------------------------------------------------------------------------------------------

(4) Although the data frame includes information about population I want to gather income data for each county to see if there is a connection with each counties average income and crimes. I grabbed income data from 2019 and combined that with the crime data from 2019, just to have an even comparison.
```{r}
data_2019 <- violent_property_crime |>
  filter(year == "2019")

md <- get_acs(geography = "county",
              variables = c(median_income = "B19013_001"),
              state = "MD",
              year = 2019)

corrected_md <- md |>
  rename(county = NAME) |>
  mutate(county = str_to_title(str_remove_all(county,", Maryland")))

md_with_2019_data <- corrected_md |> inner_join(data_2019, join_by("county" == "jurisdiction"))

md_with_2019_data |>
  group_by(county) |>
  arrange(desc(grand_total))

write_csv(md_with_2019_data, "data/census_crime_data_2019.csv")
```
-  Baltimore City had the most reported crimes in 2019 with 37,219. Kent County is still at the bottom of the rankings. 
- This makes me wonder why there aren't a lot of violent or property crimes that occur there. Is it because there population is small or that they have laws in place that make it very hard for people to commit crimes? They totaled no murders in 2019, how are they able to come out of the year clean? 
- These results also let me know that the top 3 counties with the highest total crimes in 2019 had an estimated median income of under $100,000. What correlation is there between income and crime? Does this mean that counties with a middle to high median income produces more crimes? 
- Also, does the population have anything to do with it? Montgomery County had 1 million people living there in 2019, yet they still found themselves in the Top 10.

----------------------------------------------------------------------------------------------------------------------------

(5) The information was so interesting from above I wanted to put it in map form to see how prominent the results were. Below I have linked to a map I created on Datawrapper.

Link: (review map again and put into this spot)

----------------------------------------------------------------------------------------------------------------------------

(6) Baltimore City has now ranked #1 in two calculations I've produced. I want to explore that data some more to see anything that stands out. Upon first glance, I noticed that the population in the city has fluctuated since 1975. In 2020, they had the lowest population in 45 years with 588,594 residents. 

Question: Does the decrease in population affect the rate of crime? Did specific crimes (violent or property) go up? Which ones decreased with the population? 

Answer: Although 2020 counted for the least number of people living in Baltimore City, the percentage of violent crime went up almost four percentage points. Property crime down about 11 percentage points.
```{r}
baltimore <- violent_property_crime |>
  filter(jurisdiction == "Baltimore City")
```

----------------------------------------------------------------------------------------------------------------------------

(7) Now I want to look at the violent crime percentage for Baltimore city from 1975-2020 to see which year saw the highest percentage.

```{r}
baltimore_violent_pct <- baltimore |>
  select(year, violent_crime_percent)

baltimore_violent_pct
```
- 2020 ranks the highest in violent crime percentage which is surprising to me since I thought everyone should have been in the house. Property crime made up about 66% in 2020, which was the lowest out of the 45 year period. 
- Now let's make a chart to see this in graphic form to see if there's a bigger difference.

```{r} 
#chart to display the violent crime percentage of Baltimore city
 baltimore_violent_pct |>
  ggplot() +
  geom_bar(aes(x=year, weight=violent_crime_percent)) +
  theme_economist() +
  labs(
    title="Baltimore City sees highest violent crime percentage in 2020",
    x = "year",
    y = "percentage",
    caption = "source: Governor's Office of Crime Prevention, Youth and Victim Services "
  )
```

(8) Next, I wanted to see which counties that have a high over 18 and under 18 population ranked amongst crime in 2019.

Next, I wanted to see if the counties that have a high percentage of over 18 population had any influence on the number of total crimes that occurred. Also, within the total crimes, which section saw the highest numbers, violent or property crime? Combine over_18 population data with the information to see the counties with a low population of over 18 population and see if there is any correlation with violent crime and the low rate of over 18 population. Combine 2019 over 18 data with 2019 county data. 
```{r}
county_acs_over_18 <- get_acs(geography = "county",
              variables = c(over_18 = "B09021_001"),
              state = "MD",
              year = 2019)

pop_under_18 <- get_acs(geography = "county", 
                variables = c(under_18 = "B09001_001"),
                  state = "MD", 
                  year= 2019)

county_acs_over_18 <- county_acs_over_18 |>
  rename(county = NAME) |>
  mutate(county = str_to_title(str_remove_all(county,", Maryland")))

pop_under_18 <- pop_under_18 |>
  rename(county = NAME) |>
  mutate(county = str_to_title(str_remove_all(county,", Maryland")))

county_over_18 <- county_acs_over_18 |> inner_join(data_2019, join_by("county" == "jurisdiction"))
  
county_under_18 <- pop_under_18 |> inner_join(data_2019, join_by("county" == "jurisdiction"))

county_over_18 |>
  group_by(county) |>
  arrange(desc(estimate)) |>
  select(county, estimate, grand_total, violent_crime_total, property_crime_totals)
# This let's me know that Montgomery County had the largest total of over 18 population, but they don't rank high with total crime. Out of their data, property crime outweighs violent crime. Now let's see which county has a large under 18 population and which crime sector they have more of.

county_under_18 |>
  group_by(county) |>
  arrange(desc(estimate)) |>
  select(county, estimate, grand_total, violent_crime_total, property_crime_totals)
# Montgomery County also ranks high in under 18 population, but they also don't dominate in overall crime in the state. This is interesting to me since Montgomery County seems to have a diverse age range of residents, yet they don't rank high in any grand total crime totals. Baltimore city ranks the highest in grand total crime, but finds themselves in fourth in over 18 population and five in under 18. Could we make a conclusion that people under 18 are committing the crimes in city or would be evenly weighted?

```


(9) 
```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```