---
title: "lab_09.Rmd"
author: "Shaela, Robert, Bridget, Sydney"
date: "2023-11-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(janitor)
library(lubridate)
```

Loading all the data
```{r}
jan_22_visitors <- read_csv("data/January_vistors.csv") |> clean_names()
feb_22_visitors <- read_csv("data/February_visitors.csv") |> clean_names()
mar_22_visitors <- read_csv("data/March_visitors.csv") |> clean_names()
apr_22_visitors <- read_csv("data/April_visitors.csv") |> clean_names()
may_22_visitors <- read_csv("data/May_visitors.csv") |> clean_names()
jun_22_visitors <- read_csv("data/June_visitors.csv")|> clean_names()
jul_22_visitors <- read_csv("data/July_visitors.csv") |> clean_names()
aug_22_visitors <- read_csv("data/August_visitors.csv") |> clean_names()
sep_22_visitors <- read_csv("data/September_visitors.csv") |> clean_names()
oct_22_visitors <- read_csv("data/October_visitors.csv") |> clean_names()
nov_22_visitors <- read_csv("data/November_visitors.csv") |> clean_names()
dec_22_visitors <- read_csv("data/December_visitors.csv") |> clean_names()
jan_23_visitors <- read_csv("data/jan_visitors_23.csv") |> clean_names()
feb_23_visitors <- read_csv("data/feb_visitors_23.csv") |> clean_names()
mar_23_visitors <- read_csv("data/mar_visitors_23.csv") |> clean_names()
apr_23_visitors <- read_csv("data/apr_visitors_23.csv") |> clean_names()
may_23_visitors <- read_csv("data/may_visitors_23.csv") |> clean_names()
jun_23_visitors <- read_csv("data/june_visitors_23.csv") |> clean_names()
jul_23_visitors <- read_csv("data/july_visitors_23.csv") |> clean_names()

```

We found out three groups of inconsistencies in the header. So we're cleaning up the outliers.

#cleaning records part 1
```{r}
c_jan_22_visitors <- jan_22_visitors |> rename(first_name = namefirst, last_name = namelast, middle_initial = namemid, appointment_made_date = appt_made_date, appointment_start_date = appt_start_date, appointment_end_date = appt_end_date, appointment_cancel_date = appt_cancel_date, last_updated_by = last_updatedby, last_entry_date = lastentrydate,  visitee_last_name = visitee_namelast, visitee_first_name = visitee_namefirst, meeting_location = meeting_loc, caller_last_name = caller_name_last,  caller_first_name = caller_name_first, release_date = releasedate)
```

```{r}
c_feb_22_visitors <- feb_22_visitors |> rename(first_name = namefirst, last_name = namelast, middle_initial = namemid, appointment_made_date = appt_made_date, appointment_start_date = appt_start_date, appointment_end_date = appt_end_date, appointment_cancel_date = appt_cancel_date, last_updated_by = last_updatedby, last_entry_date = lastentrydate,  visitee_last_name = visitee_namelast, visitee_first_name = visitee_namefirst, meeting_location = meeting_loc, caller_last_name = caller_name_last,  caller_first_name = caller_name_first, release_date = releasedate)
```

```{r}
c_mar_22_visitors <- mar_22_visitors |> rename(first_name = namefirst, last_name = namelast, middle_initial = namemid, appointment_made_date = appt_made_date, appointment_start_date = appt_start_date, appointment_end_date = appt_end_date, appointment_cancel_date = appt_cancel_date, last_updated_by = last_updatedby, last_entry_date = lastentrydate,  visitee_last_name = visitee_namelast, visitee_first_name = visitee_namefirst, meeting_location = meeting_loc, caller_last_name = caller_name_last,  caller_first_name = caller_name_first, release_date = releasedate)
```

```{r}
c_apr_22_visitors <- apr_22_visitors |> rename(first_name = namefirst, last_name = namelast, middle_initial = namemid, appointment_made_date = appt_made_date, appointment_start_date = appt_start_date, appointment_end_date = appt_end_date, appointment_cancel_date = appt_cancel_date, last_updated_by = last_updatedby, last_entry_date = lastentrydate,  visitee_last_name = visitee_namelast, visitee_first_name = visitee_namefirst, meeting_location = meeting_loc, caller_last_name = caller_name_last,  caller_first_name = caller_name_first, release_date = releasedate)
```

```{r}
c_may_22_visitors <- may_22_visitors |> rename(first_name = namefirst, last_name = namelast, middle_initial = namemid, appointment_made_date = appt_made_date, appointment_start_date = appt_start_date, appointment_end_date = appt_end_date, appointment_cancel_date = appt_cancel_date, last_updated_by = last_updatedby, last_entry_date = lastentrydate,  visitee_last_name = visitee_namelast, visitee_first_name = visitee_namefirst, meeting_location = meeting_loc, caller_last_name = caller_name_last,  caller_first_name = caller_name_first, release_date = releasedate)
```

#cleaning records, part 2
```{r}
c_jun_22_visitors<- jun_22_visitors |> rename(release_date = releasedate)

c_jul_22_visitors <-jul_22_visitors |> rename(release_date = releasedate)

c_aug_22_visitors <-aug_22_visitors|> rename(release_date = releasedate)

c_sep_22_visitors <-sep_22_visitors|> rename(release_date = releasedate)

c_oct_22_visitors <-oct_22_visitors |> rename(release_date = releasedate)

c_nov_22_visitors <-nov_22_visitors |> rename(release_date = releasedate)

c_dec_22_visitors <-dec_22_visitors |> rename(release_date = releasedate)

c_jan_23_visitors <-jan_23_visitors |> rename(release_date = releasedate)

c_feb_23_visitors <-feb_23_visitors |> rename(release_date =releasedate)
```

#binding the rows of the cleaned dataframes to make one big dataframe with all information in it
```{r}
wh_records_combined <- bind_rows(list(c_jan_22_visitors, c_feb_22_visitors, c_mar_22_visitors, c_apr_22_visitors, c_may_22_visitors, c_jun_22_visitors, c_jul_22_visitors, c_aug_22_visitors, c_sep_22_visitors, c_oct_22_visitors, c_nov_22_visitors, c_dec_22_visitors, c_jan_23_visitors, c_feb_23_visitors, may_23_visitors, apr_23_visitors, may_23_visitors, jun_23_visitors, jul_23_visitors))

wh_records_combined
```

#creating a column for visitor name that combines first name with last name and middle initial, creating a column of visitee name, and getting rid of unnecessary columns: the x28 and x29 columns that were only in the march 2022 data, caller_room, release_date)
```{r}
wh_records_combined_names <- wh_records_combined |> mutate(full_name_visitor = paste(first_name, middle_initial, last_name, sep = '_'),
                              full_name_visitee = paste(visitee_first_name, visitee_last_name, sep = '_'))|>
  select(-x28, -x29,-caller_room, -release_date)
```

#cleaning the dates
```{r}
wh_combined_dates_and_names <- wh_records_combined_names|>
  mutate(c_appointment_start_date = mdy_hm(appointment_start_date), 
         c_appointment_end_date = mdy_hm(appointment_end_date),
         c_appointment_cancel_date = mdy_hm(appointment_cancel_date), 
         c_last_entry_date = mdy_hm(last_entry_date),
         c_appointment_made_date = mdy_hm(appointment_made_date), 
         c_toa = mdy_hm(toa))

```
***Discussion*** 
Flaws and limitations hindering us answering our questions: after cleaning up the data, we believe we will be able to answer question 1 regarding who visited the white house most in 2022 and 2023. 

We also believe we will be able to answer question 2 - who is visited most often - by looking at the most frequently listed visitees. 

We can also look at what percentage of the visits are to the POTUS (president) or even to the FLOTUS (first lady)

For which time of day, day of the week, etc. is busiest, we could toa data, however there are several NAs in that column. So any findings we make will have to be caveated by that. Also, the date and time are combined in one column, we may need to look into how we can split those. 

Question 5 - the average length of appointment is UNATAINABLE. While time of arrival (toa) is recorded, time of departure (tod) is not. Appointment end date is always 11:59 the day of the appointment. The data will not allow us to determine length of appointments. 

Question 6 - how frequently does house or senate leadership visit the WH? A better question is what percentage of the logged visits are from leaders of the house or senate. We haven't thoroughly investigated this question yet, but we believe that we could create a list of names of high-ranking leadership: speaker of the house, minority whip, etc., and write a code using string detect and mutate to create a column that will be marked as yes if the entry is from a member of the house/senate leadership, and no if it is not. 

Additional note: cleaning up the dates, particularly in the appointment_start_date column. We believe this is because the dates are characters and some are written with the hour and minute format and others are not. Not sure if this is something that can be resolved by using open refine? 
***Discussion***


Question 1: Who visits the most? 
Answer: Michael N Herzog visits the white house the most with 108 visits. After doing research I found that he's Israel's Ambassador to the U.S.
```{r}
wh_records_combined_names |>
  group_by(full_name_visitor) |>
  summarize(
    total_visits=n()
  ) |>
  arrange(desc(total_visits))

wh_records_combined_names
```

Question 2: Who gets the most visitors?
Answer:
```{r}

```

Question 3: How frequently does the president get visitors?
```{r}
```

Question 4: What time of the day is the busiest for visitors? What day of the week? Which week of the year? (2022 = complete year
```{r}
```

Question 5: How frequently does House or Senate leadership visit the White 